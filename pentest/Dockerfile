# PHP 이미지
FROM php:5.6-apache

# mysqli 확장 설치
RUN docker-php-ext-install mysqli

# PHP LDAP 확장 기능 및 관련 라이브러리 설치
RUN apt-get update \
 && apt-get install libldap2-dev -y \
 && rm -rf /var/lib/apt/lists/* \
 && docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \
 && docker-php-ext-install ldap
    
# mod_rewrite 활성화
RUN a2enmod rewrite

# SSI 인젝션 ExecCGI 명령 사용 설정
RUN a2enmod cgi

# apache htaccess 사용 설정
COPY ./scripts/apache-config.conf /etc/apache2/sites-available/000-default.conf

# PHPMailer 설치
COPY ./api/PHPMailer-6.5.0 /var/www/PHPMailer

# TimeZone 설정 추가
RUN echo "date.timezone=Asia/Seoul" > /usr/local/etc/php/conf.d/timezone.ini

# Apache를 포그라운드에서 실행
CMD ["apache2-foreground"]
