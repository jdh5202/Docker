#!/bin/bash

# 로그인 후에 ip display 실행 ~/.bashrc 파일에 .sh path 등록 
# 네트워크 인터페이스 패턴 리스트
INTERFACE_PATTERNS=("eth[0-9]" "ens[0-9]+" "enp[0-9]+s[0-9]+" "wlan[0-9]+" "wlp[0-9]+s[0-9]+")

# IP 주소 및 인터페이스 이름 초기화
IP_ADDRESS=""
INTERFACE_NAME=""

# 각 패턴에 따라 IP 주소 추출 시도
for PATTERN in "${INTERFACE_PATTERNS[@]}"; do
    # 해당 패턴에 일치하는 네트워크 인터페이스 이름 추출
    INTERFACE=$(ip addr | grep -Eo "$PATTERN" | head -1)
    if [[ -n $INTERFACE ]]; then
        IP_ADDRESS=$(ip addr show $INTERFACE | grep "inet " | awk '{print $2}' | cut -d/ -f1)
        # IP 주소가 발견되면 인터페이스 이름 저장 및 반복 중단
        if [[ -n $IP_ADDRESS ]]; then
            INTERFACE_NAME=$INTERFACE
            break
        fi
    fi
done

# 화면에 IP 주소 출력
if [[ -n $IP_ADDRESS ]]; then
    echo "IP Address: $INTERFACE_NAME - $IP_ADDRESS" >> /home/jdh5202/scripts/test.txt
else
    echo "IP 주소를 찾을 수 없습니다." >&2
fi
